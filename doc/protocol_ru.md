# Документация по протоколу `Galaxy`

## Схема работы

Как работает протокол и, соответственно, сам сервер, может быть несколько неочевидно, поэтому считаю нужным описать это. Будет описан успешный маршрут, не включающий в себя возможные ошибки:
1. Создание сервера
- Удаленный клиент подключается к удаленному серверу `Neogrok`, назовем их `клиент` и `сервер` соответственно
- `клиент` просит создать прокси с определенными настройками
- `сервер` запускает другой сервер, назовем его `прокси-сервер` и отсылает информацию о нем `клиент`у

2. Коммуникация
- `сервер` посылает `клиент`у уведомление о подключении к `прокси-сервер`у, присваивает подключившемуся идентификатор, назовем подключившегося клиента `прокси-клиент`.
- `сервер` и `клиент` уведомляют друг друга о записи в сокет, включая при этом идентификатор записавшего `прокси-клиент`а
- `сервер` и `клиент` уведомляют друг друга о закрытии соединения в сокете


## Структура пакета

Все числа в протоколе кодируются в `little endian` пока не сказано иначе.

Каждый пакет состоит из всего двух полей: `type` и `payload`:
| Field    |      Description        |    Size     |
|----------|:-----------------------:|:-----------:|
| type     |  Packet type with flags | u8          |
| payload  |    Payload              | Unspecified |

payload зависит от типа пакета, тип пакета кодируется так([0; 7] от младшего к старшему):

|7|6|5|4|3|2| 1|0|
|-|-|-|-|-|-|-|-|
|t|t|t|t|t|с|sc|s|

- `t` - тип пакета, беззнаковое число размером 5бит
- `sc` - флаг short client
- `s` - флаг short

# TODO: Дописать документацию по протоколу
